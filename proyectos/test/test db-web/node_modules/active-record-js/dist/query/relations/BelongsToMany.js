"use strict";
var __importDefault = (this && this.__importDefault) || function (mod) {
    return (mod && mod.__esModule) ? mod : { "default": mod };
};
Object.defineProperty(exports, "__esModule", { value: true });
const Relation_1 = __importDefault(require("./Relation"));
class BelongsToMany extends Relation_1.default {
    constructor(model, related, pivot, foreignPivotKey, localPivotKey) {
        super(model, related);
        this.pivot = pivot;
        this.foreignPivotKey = foreignPivotKey;
        this.localPivotKey = localPivotKey;
        this.localKey = 'id';
    }
    buildQuery() {
        return super.buildQuery()
            .join(this.pivot, `${this.pivot}.${this.localPivotKey}`, '=', `${this.getRelatedTableName()}.id`)
            .where(`${this.pivot}.${this.foreignPivotKey}`, '=', this.getLocalKeyValue());
    }
}
exports.default = BelongsToMany;
